{
    "sourceFile": "src/main.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 28,
            "patches": [
                {
                    "date": 1697726087085,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1697849046768,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,4 @@\n-import { createApp } from 'vue'\n import './style.css'\n import App from './App.vue'\n import 'uno.css'\n \n"
                },
                {
                    "date": 1697849784114,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,5 +1,8 @@\n+import { createApp } from 'vue'\n import './style.css'\n import App from './App.vue'\n+import '@/styles/reset.css'\n import 'uno.css'\n+import '@/styles/global.scss'\n \n createApp(App).mount('#app')\n"
                },
                {
                    "date": 1697851673880,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,9 @@\n+import { createApp } from 'vue'\n+import App from './App.vue'\n+import '@/styles/reset.css'\n+import 'uno.css'\n+import '@/styles/global.scss'\n+import { router } from './router'\n+\n+\n+createApp(App).mount('#app')\n"
                },
                {
                    "date": 1697851695375,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,13 +5,7 @@\n import '@/styles/global.scss'\n import { router } from './router'\n \n \n-createApp(App).mount('#app')\n-import { createApp } from 'vue'\n-import './style.css'\n-import App from './App.vue'\n-import '@/styles/reset.css'\n-import 'uno.css'\n-import '@/styles/global.scss'\n-\n-createApp(App).mount('#app')\n+const app = createApp(App)\n+app.use(router)\n+app.mount('#app')\n"
                },
                {
                    "date": 1697851843236,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,10 +2,10 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { router } from './router'\n \n \n+\n const app = createApp(App)\n app.use(router)\n app.mount('#app')\n"
                },
                {
                    "date": 1697851849231,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,11 @@\n+import { createApp } from 'vue'\n+import App from './App.vue'\n+import '@/styles/reset.css'\n+import 'uno.css'\n+import '@/styles/global.scss'\n+import { router } from './router'\n+\n+\n+const app = createApp(App)\n+app.use(router)\n+app.mount('#app')\n"
                },
                {
                    "date": 1697851858742,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,11 @@\n+import { createApp } from 'vue'\n+import App from './App.vue'\n+import '@/styles/reset.css'\n+import 'uno.css'\n+import '@/styles/global.scss'\n+import { router } from '@/router'\n+\n+\n+const app = createApp(App)\n+app.use(router)\n+app.mount('#app')\n"
                },
                {
                    "date": 1697851864875,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,32 +2,10 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { router } from '@/router'\n+import { router } from '@router'\n \n \n const app = createApp(App)\n app.use(router)\n app.mount('#app')\n-import { createApp } from 'vue'\n-import App from './App.vue'\n-import '@/styles/reset.css'\n-import 'uno.css'\n-import '@/styles/global.scss'\n-import { router } from './router'\n-\n-\n-const app = createApp(App)\n-app.use(router)\n-app.mount('#app')\n-import { createApp } from 'vue'\n-import App from './App.vue'\n-import '@/styles/reset.css'\n-import 'uno.css'\n-import '@/styles/global.scss'\n-\n-\n-\n-const app = createApp(App)\n-app.use(router)\n-app.mount('#app')\n"
                },
                {
                    "date": 1697851870109,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { router } from '@router'\n+import { router } from '.'\n \n \n const app = createApp(App)\n app.use(router)\n"
                },
                {
                    "date": 1697851875867,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,11 @@\n+import { createApp } from 'vue'\n+import App from './App.vue'\n+import '@/styles/reset.css'\n+import 'uno.css'\n+import '@/styles/global.scss'\n+import { router } from '@'\n+\n+\n+const app = createApp(App)\n+app.use(router)\n+app.mount('#app')\n"
                },
                {
                    "date": 1697851882346,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,21 +2,10 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { router } from '@'\n+import { router } from '@/router/.js'\n \n \n const app = createApp(App)\n app.use(router)\n app.mount('#app')\n-import { createApp } from 'vue'\n-import App from './App.vue'\n-import '@/styles/reset.css'\n-import 'uno.css'\n-import '@/styles/global.scss'\n-import { router } from '.'\n-\n-\n-const app = createApp(App)\n-app.use(router)\n-app.mount('#app')\n"
                },
                {
                    "date": 1697851912193,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { router } from '@/router/.js'\n+import { router } from 'router'\n \n \n const app = createApp(App)\n app.use(router)\n"
                },
                {
                    "date": 1697851918016,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { router } from 'router'\n+import { router } from './router'\n \n \n const app = createApp(App)\n app.use(router)\n"
                },
                {
                    "date": 1697852695290,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -4,8 +4,7 @@\n import 'uno.css'\n import '@/styles/global.scss'\n import { router } from './router'\n \n-\n const app = createApp(App)\n app.use(router)\n app.mount('#app')\n"
                },
                {
                    "date": 1697853233563,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { router } from './router'\n+import { router } from '.r'\n \n const app = createApp(App)\n app.use(router)\n app.mount('#app')\n"
                },
                {
                    "date": 1697853239349,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,10 @@\n+import { createApp } from 'vue'\n+import App from './App.vue'\n+import '@/styles/reset.css'\n+import 'uno.css'\n+import '@/styles/global.scss'\n+import { router } from './route'\n+\n+const app = createApp(App)\n+app.use(router)\n+app.mount('#app')\n"
                },
                {
                    "date": 1697853246534,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,19 +2,9 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { router } from './route'\n+import { router } from './router'\n \n const app = createApp(App)\n app.use(router)\n app.mount('#app')\n-import { createApp } from 'vue'\n-import App from './App.vue'\n-import '@/styles/reset.css'\n-import 'uno.css'\n-import '@/styles/global.scss'\n-import { router } from '.r'\n-\n-const app = createApp(App)\n-app.use(router)\n-app.mount('#app')\n"
                },
                {
                    "date": 1697853257031,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { router } from './router'\n+import { routers } from './router'\n \n const app = createApp(App)\n app.use(router)\n app.mount('#app')\n"
                },
                {
                    "date": 1697853269741,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,8 +3,9 @@\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n import { routers } from './router'\n+import {} from \n \n const app = createApp(App)\n-app.use(router)\n+app.use(routers)\n app.mount('#app')\n"
                },
                {
                    "date": 1697853275492,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,11 @@\n+import { createApp } from 'vue'\n+import App from './App.vue'\n+import '@/styles/reset.css'\n+import 'uno.css'\n+import '@/styles/global.scss'\n+import { routers } from './router'\n+import {} from '.''\n+\n+const app = createApp(App)\n+app.use(routers)\n+app.mount('#app')\n"
                },
                {
                    "date": 1697853281646,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,20 +3,9 @@\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n import { routers } from './router'\n-import {} from '.''\n+import {} from './src\n \n const app = createApp(App)\n app.use(routers)\n app.mount('#app')\n-import { createApp } from 'vue'\n-import App from './App.vue'\n-import '@/styles/reset.css'\n-import 'uno.css'\n-import '@/styles/global.scss'\n-import { routers } from './router'\n-import {} from \n-\n-const app = createApp(App)\n-app.use(routers)\n-app.mount('#app')\n"
                },
                {
                    "date": 1697853289674,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -3,9 +3,10 @@\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n import { routers } from './router'\n-import {} from './src\n+import { routers } from './router'\n+import {} from './src/router'\n \n const app = createApp(App)\n app.use(routers)\n app.mount('#app')\n"
                },
                {
                    "date": 1697853295534,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,11 +2,9 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import { routers } from './router'\n-import { routers } from './router'\n-import {} from './src/router'\n+import {routers} from './src/router'\n \n const app = createApp(App)\n app.use(routers)\n app.mount('#app')\n"
                },
                {
                    "date": 1697853320220,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import {routers} from './src/router'\n+import {routers} from './router'\n \n const app = createApp(App)\n app.use(routers)\n app.mount('#app')\n"
                },
                {
                    "date": 1697853333928,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,9 +2,9 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import {routers} from './router'\n+import {router} from '@/router'\n \n const app = createApp(App)\n app.use(routers)\n app.mount('#app')\n"
                },
                {
                    "date": 1697853339697,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,10 @@\n+import { createApp } from 'vue'\n+import App from './App.vue'\n+import '@/styles/reset.css'\n+import 'uno.css'\n+import '@/styles/global.scss'\n+import {router} from '/router'\n+\n+const app = createApp(App)\n+app.use(router)\n+app.mount('#app')\n"
                },
                {
                    "date": 1697858110486,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -2,19 +2,64 @@\n import App from './App.vue'\n import '@/styles/reset.css'\n import 'uno.css'\n import '@/styles/global.scss'\n-import {router} from '/router'\n+import { router } from './router'\n+import { createPinia } from 'pinia'\n+import piniaPluginPersistedstate from 'pinia-plugin-persistedstate'\n+import { useUserStore } from './store/user'\n+import { usePermissionStore } from './store/permission'\n+import { NOT_FOUND_ROUTE } from '@/router/routes'\n \n const app = createApp(App)\n app.use(router)\n+\n+const pinia = createPinia()\n+/**\n+ * 持久化\n+ * 文档: https://prazdevs.github.io/pinia-plugin-persistedstate/zh/guide/\n+ */\n+pinia.use(piniaPluginPersistedstate)\n+app.use(pinia)\n+\n app.mount('#app')\n-import { createApp } from 'vue'\n-import App from './App.vue'\n-import '@/styles/reset.css'\n-import 'uno.css'\n-import '@/styles/global.scss'\n-import {router} from '@/router'\n \n-const app = createApp(App)\n-app.use(routers)\n-app.mount('#app')\n+// 添加路由守卫\n+const WHITE_LIST = ['/login', '/404']\n+router.beforeEach(async (to) => {\n+  const userStore = useUserStore()\n+  const permissionStore = usePermissionStore()\n+  const token = userStore.token\n+\n+  /**\n+   * 没有token的情况\n+   * 如果是白名单则通过，否则跳转登录页\n+   */\n+  if (!token) {\n+    if (WHITE_LIST.includes(to.path)) return true\n+    return { path: 'login' }\n+  }\n+\n+  /**\n+   * 有token的情况\n+   * 判断有没有获取用户信息，有则通过，无则获取用户信息\n+   */\n+  if (!userStore.userInfo?.id) {\n+    // 获取用户信息\n+    await userStore.getUserInfo()\n+    // 创建权限路由列表\n+    const accessRoutes = permissionStore.generateRoutes(userStore.role)\n+    // 动态添加有权限的路由\n+    accessRoutes.forEach((route) => {\n+      !router.hasRoute(route.name) && router.addRoute(route)\n+    })\n+    // 将无法匹配的路由添加到路由列表的最后面\n+    router.addRoute(NOT_FOUND_ROUTE)\n+    // 添加完路由后重走路由守卫\n+    return { ...to, replace: true }\n+  }\n+\n+  // 已登录的状态下进入登录页时强制跳回到首页\n+  if (to.path === '/login') return { path: '/' }\n+\n+  return true\n+})\n"
                },
                {
                    "date": 1698144723741,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -5,11 +5,13 @@\n import '@/styles/global.scss'\n import { router } from './router'\n import { createPinia } from 'pinia'\n import piniaPluginPersistedstate from 'pinia-plugin-persistedstate'\n+import { pmsBtn } from '@/directives'\n import { useUserStore } from './store/user'\n import { usePermissionStore } from './store/permission'\n import { NOT_FOUND_ROUTE } from '@/router/routes'\n+import { setupNaiveDiscreteApi } from './utils/naiveTools'\n \n const app = createApp(App)\n app.use(router)\n \n@@ -19,8 +21,10 @@\n  * 文档: https://prazdevs.github.io/pinia-plugin-persistedstate/zh/guide/\n  */\n pinia.use(piniaPluginPersistedstate)\n app.use(pinia)\n+app.directive('pmsBtn', pmsBtn) // 注册按钮权限自定义指令\n+setupNaiveDiscreteApi()\n \n app.mount('#app')\n \n // 添加路由守卫\n@@ -46,9 +50,9 @@\n   if (!userStore.userInfo?.id) {\n     // 获取用户信息\n     await userStore.getUserInfo()\n     // 创建权限路由列表\n-    const accessRoutes = permissionStore.generateRoutes(userStore.role)\n+    const accessRoutes = permissionStore.generateRoutes(userStore.role?.code)\n     // 动态添加有权限的路由\n     accessRoutes.forEach((route) => {\n       !router.hasRoute(route.name) && router.addRoute(route)\n     })\n"
                }
            ],
            "date": 1697726087085,
            "name": "Commit-0",
            "content": "import { createApp } from 'vue'\nimport './style.css'\nimport App from './App.vue'\nimport 'uno.css'\n\ncreateApp(App).mount('#app')\n"
        }
    ]
}